<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html>
<head>
<title>
SnertSoft - @PACKAGE_NAME@/@PACKAGE_VERSION@ for Sendmail
</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="keywords" content="Sendmail milter mail filter gateway call ahead call back antispam anti spam" />
<meta name="description" content="A call-ahead milter that allows a gateway to verify recipients with an internal mail store." />
<link rel="stylesheet" type="text/css" href="./style.css" />
<script language="JavaScript" type="text/javascript" src="./mailto.js"></script>
</head>

<body>
<div align="center">
<table cellpadding="0" cellspacing="0" border="0" width="700" style="padding: 0px 10px 0px 10px;">
<tr><td>

<a href="http://www.snertsoft.com/">
<img alt="SnertSoft: We Serve Your Server" src="Img/logo-300x74.png" width="300" height="74" border="0" /></a>

<div align="center">
<h1 class="title">
@PACKAGE_NAME@/@PACKAGE_VERSION@
<br/><span class="large">&laquo;Call Ahead to Reserve&raquo;</span>
</h1>
<br/>
<a href="#">Description &amp; Usage</a> &deg;
<a href="#Installation">Installation &amp; Notes</a> &deg;
<a href="#License">License &amp; Support</a>
</div>

<a name="Warning"></a>
<h3>WARNING</h3>
<p class="warn">
THIS IS MAIL FILTERING SOFTWARE AND WILL BLOCK MAIL THAT FAILS TO PASS A GIVEN SET OF TESTS.
SNERTSOFT AND THE AUTHOR DO NOT ACCEPT ANY RESPONSIBLITY FOR MAIL REJECTED OR POSSIBLE
LOSS OF BUSINESSS THROUGH THE USE OF THIS SOFTWARE. BY INSTALLING THIS SOFTWARE THE CLIENT
UNDERSTANDS AND ACCEPTS THE RISKS INVOLVED.
</p>

<a name="Description"></a>
<h3>Description</h3>

<p>
This <a href="http://www.sendmail.org/">Sendmail</a> mail filter allows a gateway mail server
to call-ahead to another MX server or internal mail store before accepting mail for recipients
of a message. Think of it as a lazy man's LDAP. It could also be used by fallback MX servers to
verify recipients with the primary MX. This milter was derived from a similar facility found in
<a href="http://www.snertsoft.com/sendmail/milter-sender/">milter-sender</a>.
</p>

<p>
<code>milter-ahead</code> can use its own database and/or use Sendmail's FEATURE(`mailertable'),
which is passed to the milter through {rcpt_addr}, {rcpt_host}, and {rcpt_mailer} macros.
</p>

<blockquote><pre>
snert.com       esmtp:[pop.snert.net]
</pre></blockquote>

<p>
With the square-brackets around a host name or IP address, the route is <i>well defined</i> and
the postmaster knows exactly which server is the next hop for mail in the recipient domain. This
milter does not perform MX lookups when the square brackets are missing by default and thus would
skip the call-ahead test (see <a href="#opt_mx_lookup">mx-lookup</a>).
</p>

<!-- Common Milter Options -->

<a name="Usage"></a>
<h3>Usage</h3>

<blockquote style="text-align: left;">
<nobr><code>@PACKAGE_NAME@</code> <span class="syntax">[options ...][arguments ...]</span></nobr>
</blockquote>

<p>
Options can be expressed in four different ways. Boolean options
are expressed as <span class="syntax">+option</span> or <span class="syntax">-option</span>
to turn the option on or off respectively. Options that required a value are expressed as
<span class="syntax">option=value</span> or <span class="syntax">option+=value</span> for
appending to a value list. Note that the <span class="syntax">+option</span> and
<span class="syntax">-option</span> syntax are equivalent to <span class="syntax">option=1</span>
and <span class="syntax">option=0</span> respectively. Option names are case insensitive.
</p>
<p>
Some options, like <span class="syntax">+help</span>
or <span class="syntax">-help</span>, are treated as immediate actions or commands.
Unknown options are ignored. The first command-line argument is that which does not adhere
to the above option syntax. The special command-line argument <span class="syntax">--</span>
can be used to explicitly signal an end to the list of options.
</p>
<p>
The default options, as shown below, can be altered by specifying them on the command-line
or within an option file, which simply contains command-line options
one or more per line and/or on multiple lines. Comments are allowed and are denoted by a
line starting with a hash (#) character. If the <a href="#opt_file">file</a> option is defined
and not empty, then it is parsed first followed by the command-line options.
</p>

<p>
Note that there may be additional options that are listed in the option summary
given by <span class="syntax">+help</span> or <span class="syntax">-help</span>
that are not described here.
</p>

<dl>

<h3>Options</h3>

<!-- Common B/W listing options. -->

<a name="opt_access_db"></a>
<dt><span class="syntax">access-db=</span><span class="param"><!-- /etc/mail/access.db --></span></dt>
<dd>

<span class="note">
Note that @PACKAGE_NAME@ typically does <strong>not</strong> require this option be enabled,
unlike other SnertSoft milters.
</span>

<p>
The type and location of the read-only access key-value map.
It provides a centralised means to black and white list hosts,
domains, mail addresses, etc. The following methods are supported:
</p>
<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td width="60%" class="syntax tline">text!/path/map.txt</td><td width="40%" class="tline">R/O text file, memory hash</td></tr>
<tr><td width="60%" class="syntax">/path/map.db</td><td width="40%">Berkeley DB hash format</td></tr>
<tr><td width="60%" class="syntax">db!/path/map.db</td><td width="40%">Berkeley DB hash format</td></tr>
<tr><td width="60%" class="syntax">db!btree!/path/map.db</td><td width="40%">Berkeley DB btree format</td></tr>
<tr><td width="60%" class="syntax">sql!/path/database</td><td width="40%">An SQLite3 database</td></tr>
<tr><td width="60%" class="syntax">socketmap!host:port</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="syntax">socketmap!/path/local/socket</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="syntax">socketmap!123.45.67.89:port</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="syntax bline">socketmap![2001:0DB8::1234]:port</td><td width="40%" class="bline">Sendmail style socket-map</td></tr>
</table>
</blockquote>
<p>
If :port is omitted, the default is 7953.
</p>
<p>
The access-db contains key-value pairs. Lookups are performed
from most to least specific, stopping on the first entry found.
Keys are case-insensitive.
</p>


<a name="access_lookups"></a>
<p>
There are essentially three types of keys used in the <a href="#opt_access_map">access-db</a>.
Many of the tags available will use one or more of these lookup sequences.
</p>

<dl>
<dt>IP Address Lookups</dt>
<dd>
An IP address lookup is typically applied to the connected SMTP client.
It will start with a complete IPv4 or IPv6 address and break it down
on delimiter boundaries from right to left.

<p>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td rowspan="9" width="6%">&nbsp;</td><th width="47%">IPv6 Lookup</th><th width="47%">IPv4 Lookup</th></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0:0:0:1234:5678</td><td><span class="tag">tag:</span>192.0.2.9</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0:0:0:1234</td><td><span class="tag">tag:</span>192.0.2</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0:0:0</td><td><span class="tag">tag:</span>192.0</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0:0</td><td><span class="tag">tag:</span>192</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0</td><td rowspan="4">&nbsp;</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8</td></tr>
<tr><td><span class="tag">tag:</span>2001</td></tr>
</table>
</p>

<p>
Note that the compact form of an IPv6 address, "<code>2001:0DB8::1234:5678</code>", <em>cannot</em> be used.
Only the full IPv6 address format, with all intervening zeros, is currently supported.
</p>

</dd>

<dt>Domain Name Lookups</dt>
<dd>
A domain lookup may be applied to either the connected SMTP client,
where the client's host name found through a <!-- a class="glossary" href="glossary.html#term_PTR" -->DNS PTR</a> record is searched for, or
using the domain portion of an mail address (see below). A domain lookup will try the IP-domain literal
if applicable, then continue with the <!-- a class="glossary" href="glossary.html#term_FQDN" -->FQDN</a>, breaking it down one label
at a time from left to right.

<p>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td rowspan="6" width="6%">&nbsp;</td><td><span class="tag">tag:</span>[ipv6:2001:0DB8::1234:5678]</td></tr>
<tr><td><span class="tag">tag:</span>[192.0.2.9]</td></tr>
<tr><td><span class="tag">tag:</span>sub.domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>tld</td></tr>
<tr><td><span class="tag">tag:</span></td></tr>
</table>
</p>

<p>
Note that the bare tag is often used to specify system wide defaults.
</p>
</dd>

<dt>Mail Address Lookups</dt>
<dd>
A mail address lookup is similar to a domain lookup, but the search
first starts with a complete mail address, before trying the address's
domain, and finally only the local part of the address.

<p>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td rowspan="6" width="6%">&nbsp;</td><td><span class="tag">tag:</span>account@sub.domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>sub.domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>tld</td></tr>
<tr><td><span class="tag">tag:</span>account@</td></tr>
<tr><td><span class="tag">tag:</span></td></tr>
</table>
</p>

<p>
Note that the bare tag is often used to specify system wide defaults.
</p>
</dd>
</dl>

<a name="access_tags"></a>
<h4>Tags</h4>
<p>
The following list outlines the available tags and their supported key lookups:
</p>

<dl>

<a name="tag_auth"></a>
<dt><span class="tag">@PACKAGE_NAME@-Auth:</span>auth_authen</dt>
<dt><span class="tag">@PACKAGE_NAME@-Auth:</span></dt>
<dd>
Used to black or white list by authenticated user (SMTP AUTH) as given
by the macro <code>{auth_authen}</code>.

The string searched by the pattern list will be the sender's mail address.
The empty form of <span class="tag">@PACKAGE_NAME@-Auth:</span> allows for a
milter specific default only when <code>{auth_authen}</code> is defined.
</dd>

<a name="tag_connect_from"></a>
<dt><span class="tag">@PACKAGE_NAME@-Connect:</span>ip<span class="tag">:From:</span>mail</dt>
<dt><span class="tag">@PACKAGE_NAME@-Connect:</span>domain<span class="tag">:From:</span>mail</dt>
<dd>
This set of combination tags are used to black or white list sender
addresses when sent from a given SMTP client. The
sender address can be easily forged and using the <span class="tag">From:</span>
tag by itself could allow spam with a forged address. By adding the
sender's SMTP client as an extra constraint, it is possible to limit
such abuse.
<span class="note">
Note that the lookup variants with blank IP, domain, or mail are not supported.
</span>
</dd>

<a name="tag_connect"></a>
<dt><span class="tag">@PACKAGE_NAME@-Connect:</span>ip</dt>
<dt><span class="tag">@PACKAGE_NAME@-Connect:</span>domain</dt>
<dt><span class="tag">Connect:</span>ip</dt>
<dt><span class="tag">Connect:</span>domain</dt>
<dd>
Used to black or white list an SMTP client.
<span class="note">Note that Sendmail also has special semantics for <span class="tag">Connect:</span>.</span>
</dd>

<a name="tag_connect_to"></a>
<dt><span class="tag">@PACKAGE_NAME@-Connect:</span>ip<span class="tag">:To:</span>mail</dt>
<dt><span class="tag">@PACKAGE_NAME@-Connect:</span>domain<span class="tag">:To:</span>mail</dt>
<dd>
This set of combination tags are used to black or white list recipient
addresses that a given SMTP client may contact. This allows for
finer granularity of control in place of the <span class="tag">To:</span> tag.
<span class="note">
Note that the lookup variants with blank IP, domain, or mail are not supported.
</span>
</dd>

<a name="tag_from_to"></a>
<dt><span class="tag">@PACKAGE_NAME@-From:</span>mail<span class="tag">:To:</span>mail</dt>
<dd>
This set of combination tags are used to black or white list a pair of sender
and recipient addresses. This allows for finer granularity of control in place
of the <span class="tag">To:</span> tag.
<span class="note">
Note that the lookup variants with blank mail elements are not supported.
</span>
</dd>

<a name="tag_from"></a>
<dt><span class="tag">@PACKAGE_NAME@-From:</span>mail</dt>
<dt><span class="tag">From:</span>mail</dt>
<dd>
Used to black or white list a sender's mail address. Black listing using
this tag is fine, but white listing is <em>not</em> recommended as it is too easy
for someone to fake the sender address or domain.

In the case of a +detailed mail address, the left hand side of the +detail is used for the <i>sender@</i> lookup.

<span class="note">Note that Sendmail also has special semantics for <span class="tag">From:</span>.</span>
</dd>

<a name="tag_to"></a>
<dt><span class="tag">@PACKAGE_NAME@-To:</span>mail</dt>
<dt><span class="tag">Spam:</span>mail</dt>
<dt><span class="tag">To:</span>mail</dt>
<dd>
Used to black or white list a recipient's mail address.
In the case of a +detailed mail address, the left hand side of the +detail is used for the <i>sender@</i> lookup.
<span class="note">Note that Sendmail also has special semantics for <span class="tag">To:</span> and <span class="tag">Spam:</span>.</span>

</dd>
</dl>

<a name="access_simple_value"></a>
<h4>Action</h4>
<p>
When a key lookup matches, then the value returned is a pattern list, which in
its simplest and most common form is either an action word like
<code>OK</code>, <code>REJECT</code>, etc.;
a numerical value; or some arbitrary string depending on the tag involved. For example:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top"><td width="41%" class="key bdotted tline">Connect:192.168.0</td><td width="59%" class="value bdotted tline">OK</td></tr>
<tr valign="top"><td width="41%" class="key bdotted">Rate-Connect:fsl.com</td><td width="59%" class="value bdotted">17</td></tr>
<tr valign="top"><td width="41%" class="key bline">Msg-Limit-From:hotmail.com</td><td width="59%" class="value bline">150/30m</td></tr>
</table>
</blockquote>

<a name="access_action_words"></a>
<p>
The action words supported by @PACKAGE_NAME@ are:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top"><td width="41%" class="value bdotted tline">OK</td><td width="59%" class="bdotted tline">White list, by-pass one or more tests.</td></tr>
<tr valign="top"><td width="41%" class="value bdotted">REJECT</td><td width="59%" class="bdotted">Black list, reject connection, sender, recipient, etc.</td></tr>
<tr valign="top"><td width="41%" class="value bdotted">SKIP</td><td width="59%" class="bdotted">Stop lookup and return no result ie. continue testing.</td></tr>
<tr valign="top"><td width="41%" class="value bline">DUNNO</td><td width="59%" class="bline">Same as SKIP, commonly used by postfix.</td></tr>
</table>
</blockquote>


<a name="access_pattern_lists"></a>
<h4>Pattern Lists</h4>
<p>
In most instances, the above forms of key lookup and values are sufficient. However,
there may be times when finer granularity of control is required, in which case
pattern lists can be used.

A pattern list is a white space separated list of <i class="syntax">pattern-action</i>
pairs followed by an optional default action. The supported types are:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tr valign="top"><td class="value bdotted tline" width="41%">[network/cidr]action</td><td class="bdotted tline">Classless Inter-Domain Routing<br/>(only with IP address lookups)</td></tr>
<tr valign="top"><td class="value bdotted">!pattern!action</td><td class="bdotted">Simple fast text matching. <br/></td></tr>
<tr valign="top"><td class="value bline">/regex/action</td><td class="bline">POSIX Extended Regular Expressions.</td></tr>
</table>
</blockquote>

<a name="access_simple_pattern"></a>
<p>
The simple pattern matching, <span class="value">!pattern!</span>,
uses an asterisk (*) for a wildcard, scanning over  zero or more characters;
a question-mark (?) matches any single character; a backslash followed by
any character treats that character as a literal. This method always
tries to match the beginning and end of string. For example:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top"><td class="value bdotted tline" width="41%">!abc!</td><td class="bdotted tline">exact match for 'abc'</td></tr>
<tr valign="top"><td class="value bdotted">!abc*!</td><td class="bdotted">match 'abc' at start of string</td></tr>
<tr valign="top"><td class="value bdotted">!*abc!</td><td class="bdotted">match 'abc' at the end of string</td></tr>
<tr valign="top"><td class="value bdotted">!abc*def!</td><td class="bdotted">match 'abc' at the start and match 'def' at the end, maybe with stuff in between.</td></tr>
<tr valign="top"><td class="value bline">!*abc*def*!</td><td class="bline">find 'abc', then find 'def'</td></tr>
</table>
</blockquote>

<p>
The following is an example using a simple pattern to reject client connections
that originate from a range of IP addresses of an ISP assigned to ADSL customers.
Using a pattern like this allows you to drop connects from the ISP's ADSL, while still
accepting connections from mail and web servers.
</p>

<blockquote><pre>
Connect:hananet.net	!adsl-*-*.usr.hananet.net!REJECT
</pre></blockquote>

<p>
If you know that an ISP's mail and web servers follow a standard naming convention,
you might prefer to only accept mail from those instead. We include web servers here
to handle the case where a web server might have to send a mail response based on
a form being filled in.
</p>

<blockquote><pre>
Connect:hananet.net	!smtp*.hananet.net!OK !www*.hananet.net!OK REJECT
</pre></blockquote>

<a name="access_about_spf"></a>
<p>
Note that <a class="glossary" href="http://tools.ietf.org/html/rfc4408" target="_blank">SPF</a>
was designed to help mail servers identify
originators of mail, so creating patterns as shown in the above two examples
is not normally required. However, SPF is still considered experimental and not
as widely deployed as one might hope.
</p>

<a name="access_regex_pattern"></a>
<p>
The next example, <span class="value">/regex/</span>, uses Extended Regular Expressions to validate the
format of the local-part of an AOL address, which must be between 3 and 16
characters long, can contain dots and RFC 2822 ``atext'' characters except <code>%</code> and <code>/</code>.
The SKIP word allows the one regular expression to validate the format of the address and continue if the
pattern matches; otherwise if the regular expression failed to match, REJECT the suspect aol.com address.
</p>

<blockquote style="font-family: monospace;">
From:grandma@aol.com OK
<br/>From:aol.com /^[a-zA-Z0-9!#$&amp;'*+=?^_`{|}~.-]{3,16}@aol.com$/SKIP REJECT
</blockquote>

<p>
The discussion of Extended Regular Expressions is vast and complex, well beyond the
scope of this document. There are many on-line tutorials and references available and the book
<a href="http://www.oreilly.com/catalog/regex3/index.html">Mastering Regular Expressions, 3e</a> from O'Reilly covers the topic in depth.
</p>

<p>
If you need to use a pattern list, then try and follow these suggestions:
</p>
<ul>
<li>
A pattern cannot be used as the key in an <a href="#opt_access_db">access-db</a>
lookup. Key-value tables work with constants for the keys using a predefined lookup order
as outlined <a href="#access_lookups">above</a>.
</li>
<li>Use the key lookup as a selector to find a pattern list.</li>
<li>Use simple <a href="#access_simple_pattern">!pattern!</a> matching where possible, as it will be
faster than Extended Regular Expressions, <a href="#access_regex_pattern">/regex/</a>.
</li>
<li>
Avoid using pattern lists with bare tag variants that specify a global default.
It will more often than not cause a lot of unnecessary attempts to match a pattern.
</li>
<li>
Keep your pattern lists short &amp; simple.
</li>
</ul>

<p>
The <span class="tag">@PACKAGE_NAME@-Connect:</span>, <span class="tag">@PACKAGE_NAME@-From:</span>, and
<span class="tag">@PACKAGE_NAME@-To:</span> tags provide a milter specific means to override
the Sendmail and Postfix variants. For example, you normally white list your local network through any and all milters, but
on the odd occasion you might want to actually scan mail from inside going out, without removing the Connect: tag that
allows Sendmail or Postfix to relay for your network or white listing for other milters.
So for example if you have tags like:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="syntax">
	<td width="65%">To:mx.example.com</td><td width="35%">RELAY</td>
</tr>
</table>
</blockquote>

<p>
You might have to add milter specific overrides in order to make sure the
mail still gets filtered:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="syntax">
	<td width="65%">To:mx.example.com</td><td width="35%">RELAY</td>
</tr>
<tr class="syntax">
	<td>@PACKAGE_NAME@-To:mx.example.com</td><td>SKIP</td>
</tr>
</table>
</blockquote>

<p>
Some additional examples:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="syntax" valign="top">
	<td width="40%" class="tline">@PACKAGE_NAME@-Connect:80.94</td>
	<td width="60%" class="tline" style="text-align: right;">[80.94.96.0/20]OK&nbsp;&nbsp;REJECT</td>
</tr>
<tr><td colspan="2">&nbsp;</td></tr>
<tr class="normal">
	<td colspan="2">
		Accept connections from the netblock 80.94.96.0/20 (80.94.96.0 through to 80.94.111.255) and
		rejecting anything else in 80.94.0.0/16.
	</td>
</tr>
<tr><td colspan="2" class="bline">&nbsp;</td></tr>
<tr class="syntax" valign="top">
	<td width="40%">@PACKAGE_NAME@-Connect:192.0.2</td>
	<td width="60%" style="text-align: right;">/^192\.0\.2\.8[0-9]/OK&nbsp;&nbsp;REJECT</td>
</tr>
<tr><td colspan="2">&nbsp;</td></tr>
<tr class="normal">
	<td colspan="2">
		Accept connections from 192.0.2.80 through to 192.0.2.89, reject everything else in 192.0.2.0/24.
	</td>
</tr>
<tr><td colspan="2" class="bline">&nbsp;</td></tr>
<tr class="syntax" valign="top">
	<td width="40%">@PACKAGE_NAME@-From:example.com</td>
	<td width="60%" style="text-align: right;">/^john@.+/OK&nbsp;&nbsp;/^fred\+.*@.*/OK&nbsp;&nbsp;REJECT</td>
</tr>
<tr><td colspan="2">&nbsp;</td></tr>
<tr class="normal">
	<td colspan="2">
		Accept mail from &lt;john@example.com&gt; and &lt;fred@example.com&gt; when fred's address
		contains a plus-detail in the address. Reject everything else from example.com.
	</td>
</tr>
<tr><td colspan="2" class="bline">&nbsp;</td></tr>
<tr class="syntax" valign="top">
	<td width="40%">@PACKAGE_NAME@-To:example.net</td>
	<td width="60%" style="text-align: right;">!*+*@*!REJECT&nbsp;&nbsp;!*.smith@*!REJECT&nbsp;&nbsp;/^[0-9].*/REJECT</td>
</tr>
<tr><td colspan="2">&nbsp;</td></tr>
<tr class="normal">
	<td colspan="2">
		Reject mail to example.net using a plus-detail address or to any user who's last name is "smith" or addresses
		starting with a digit. No default given, so it is assumed to be SKIP..
	</td>
</tr>
<tr><td colspan="2" class="bline">&nbsp;</td></tr>
</table>
</blockquote>

</dd>

<!-- end common B/W listing options -->

<a name="opt_backup_mx"></a>
<dt><span class="syntax">+backup-mx</span></dt>
<dd>For a backup MX or gateway, accept mail when the down stream mail server is unreachable or when
the server returns 421 server busy or 554 no service responses.
</dd>

<a name="opt_cache_accept_ttl"></a>
<dt><span class="syntax">cache-accept-ttl=</span><span class="param">604800</span></dt>
<dd>The cache time-to-live in seconds for positive responses.
The cache remembers the results of a previous call-ahead.
</dd>

<a name="opt_cache_file"></a>
<dt><span class="syntax">cache-file=</span><span class="param">/var/db/milter-limit.db</span></dt>
<dd>
The file path used for BDB or flatfile cache types.
</dd>

<a name="opt_cache_gc_frequency"></a>
<dt><span class="syntax">cache-gc-frequency=</span><span class="param">250</span></dt>
<dd>This option specifies the cache garbage collection frequency,
which is based on the number of SMTP connections (not messages) handled by the milter. Every
N connections, the cache is traversed to remove expired entries.
</dd>

<a name="opt_cache_reject_ttl"></a>
<dt><span class="syntax">cache-reject-ttl=</span><span class="param">90000</span></dt>
<dd>The cache time-to-live in seconds for negative responses.
The cache remembers the results of a previous call-ahead.
</dd>

<a name="opt_cache_type"></a>
<dt><span class="syntax">cache-type=</span><span class="param">bdb</span></dt>
<dd>The cache <span class="param">type</span> can be one of: <code>bdb</code>,
<code>flatfile</code>, <code>hash</code>.
</dd>

<a name="opt_call_ahead_host"></a>
<dt><span class="syntax">call-ahead-host=</span><span class="param"></span></dt>
<dd>Force the call-ahead always to this <span class="param">host</span>,
overriding the {rcpt_host} determined by Sendmail. This option is
undefined by default. This option overrides <a href='#opt_mx_lookup'>mx-lookup</a>.
</dd>

<a name="opt_call_ahead_db"></a>
<dt><span class="syntax">call-ahead-db=</span><span class="param"></span></dt>
<dd>
When specified, the parameter is the type and location of a read-only key-value map.
The following variants are supported:

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td width="60%" class="syntax tline">text!/path/map.txt</td><td width="40%" class="tline">R/O text file, memory hash</td></tr>
<tr><td width="60%" class="syntax">/path/map.db</td><td width="40%">Berkeley DB hash format</td></tr>
<tr><td width="60%" class="syntax">db!/path/map.db</td><td width="40%">Berkeley DB hash format</td></tr>
<tr><td width="60%" class="syntax">db!btree!/path/map.db</td><td width="40%">Berkeley DB btree format</td></tr>
<tr><td width="60%" class="syntax">sql!/path/database</td><td width="40%">An SQLite3 database</td></tr>
<tr><td width="60%" class="syntax">socketmap!host:port</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="syntax">socketmap!/path/local/socket</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="syntax">socketmap!123.45.67.89:port</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="syntax bline">socketmap![2001:0DB8::1234]:port</td><td width="40%" class="bline">Sendmail style socket-map</td></tr>
</table>
</blockquote>

<p>
The recipient's domain is first used as the lookup key followed by each parent
domain component that makes up the domain name. If no key is found, then the
value of {rcpt_host} will be used.
</p>
<p>
When a key is found, then the value returned must be the name or IP
of the mail server to consult surrounded by square brackets. An optional <code>:port</code>
specifier may follow the closing square bracket. To consult the MX of another
domain specify the other domain name to lookup. This only works when
<a href="#opt_mx_lookup">mx-lookup</a> is enabled. Note that <code>:port</code>
cannot be used in this case, because using an MX implies SMTP port 25.
</p>
<p>
Below is an example of what the database file might look like
with using IPv4, IPv6, hostname, and MX of domain values:
</p>
<blockquote>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tr valign="top">
	<td class="tline" width="60%">snert.biz</td>
	<td class="tline" width="40%">[192.0.2.7]</td>
</tr>
<tr valign="top">
	<td width="60%">snert.com</td>
	<td width="40%">[192.0.2.7]:1234</td>
</tr>
<tr valign="top">
	<td width="60%">snert.eu</td>
	<td width="40%">[2001:0DB8::beef]</td>
</tr>
<tr valign="top">
	<td width="60%">snert.fr</td>
	<td width="40%">[2001:0DB8::beef]:1234</td>
</tr>
<tr valign="top">
	<td width="60%">snert.info</td>
	<td width="40%">[pop.snert.example]</td>
</tr>
<tr valign="top">
	<td width="60%">mx.snert.net</td>
	<td width="40%">[smtp.snert.example]:1234</td>
</tr>
<tr valign="top">
	<td class="bline" width="60%">snert.net</td>
	<td class="bline" width="40%">snert.org</td>
</tr>
</table>
</blockquote>
</dd>

<a name="opt_is_blind_mx"></a>
<dt><span class="syntax">+is-blind-mx</span></dt>
<dd>
Test whether the call-ahead host is blind MX and cache the result so
that furture call-aheads to a blind MX can be ignored. A blind MX is
a host which accepts any recipient only to bounce later. Some servers
like Exchange in their default configuration behave this way. Also
catch-all addresses will cause this behaviour too.
</dd>

<a name="opt_mx_lookup"></a>
<dt><span class="syntax">-mx-lookup</span></dt>
<dd>
Enable MX lookups of the {rcpt_host} or of the domain found in the <a href="#opt_call_ahead_db">call-ahead-db</a>.
</dd>

<a name="opt_mx_reject"></a>
<dt><span class="syntax">-mx-reject=</span><span class="param">all</span></dt>
<dd>
A comma separated word list.
Reject an MX that resolves to RFC 3330, 3513, or 3849 reserved IP addresses.

<blockquote>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tr>
	<td class="tline" width="20%">all</td>
	<td class="tline" width="40%">all reserved IP address</td>
	<td class="tline" width="40%">&nbsp;</td>
</tr>
<tr>
	<td>0</td>
	<td>accept all.</td>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>benchmark</td>
	<td>198.18.0.0/15</td>
	<td>RFC 2544</td>
</tr>
<tr>
	<td>link-local</td>
	<td>169.254.0.0/16, FE80::/10 </td>
	<td>RFC 3330, 3513</td>
</tr>
<tr>
	<td>localhost</td>
	<td>127.0.0.1, ::1</td>
	<td>RFC 3330, 3513</td>
</tr>
<tr>
	<td>loopback</td>
	<td>127.0.0.0/8</td>
	<td>excluding 127.0.0.1</td>
</tr>
<tr>
	<td>multicast</td>
	<td>224.0.0.0/4, FF00::/8</td>
	<td>RFC 3330, 3513</td>
</tr>
<tr>
	<td>private-a</td>
	<td>10.0.0.0/8</td>
	<td>RFC 3330</td>
</tr>
<tr>
	<td>private-b</td>
	<td>172.16.0.0/12</td>
	<td>RFC 3330</td>
</tr>
<tr>
	<td>private-c</td>
	<td>192.168.0.0/16</td>
	<td>RFC 3330</td>
</tr>
<tr>
	<td>reserved</td>
	<td>IPv6 unassigned prefixes</td>
	<td>RFC 3513</td>
</tr>
<tr>
	<td>site-local</td>
	<td>FEC0::/10</td>
	<td>RFC 3513</td>
</tr>
<tr>
	<td>test-net</td>
	<td>192.0.2.0/24, 2001:DB8::/32</td>
	<td>RFC 3513, 3849</td>
</tr>
<tr>
	<td class="bline">this-net</td>
	<td class="bline">0.0.0.0/8, ::0</td>
	<td class="bline">RFC 3330, 3513</td>
</tr>
</table>
</blockquote>
</dd>

<a name="opt_daemon"></a>
<dt><span class="syntax">+daemon</span></dt>
<dd>Start as a background daemon or foreground application.
</dd>

<a name="opt_file"></a>
<dt><span class="syntax">file=</span><span class="param">/etc/mail/@PACKAGE_NAME@.cf</span></dt>
<dd>Read the option file before command line options. This option is set by default.
To disable the use of an option file, simply say <span class="syntax">file=''</span>
</dd>

<a name="opt_help"></a>
<dt><span class="syntax">-help</span> or <span class="syntax">+help</span></dt>
<dd>Write the option summary to standard output and exit.
The output is suitable for use as an option file.
</dd>

<a name="opt_ignore_rcpt_host"></a>
<dt><span class="syntax">-ignore-rcpt-host</span></dt>
<dd>
When using the <a href="#opt_call_ahead_db">call-ahead-db</a> option, in particular to call-ahead past
an anti-virus server for example, falling back on the {rcpt_host} for the call-ahead
would result often in a redundant connection to a machine that accepts any recipient.
This option disables the call-ahead when {rcpt_host} is the target.
</dd>

<a name="opt_info"></a>
<dt>&plusmn;<span class="syntax">info</span></dt>
<dd>
Write the configuration and compile time options to standard output
and exit.
</dd>

<a name="opt_max_failures"></a>
<dt><span class="syntax">max-failures=</span><span class="param">5</span></dt>
<dd>
Maximum number of call-ahead failures initiated from the same
client IP before being blocked until the cache entry expires.
</dd>

<a name="opt_milter_socket"></a>
<dt><span class="syntax">milter-socket=</span><span class="param">unix:@snert_socket_file@</span></dt>
<dd>A socket specifier used to communicate between Sendmail and <code>@PACKAGE_NAME@</code>.
Typically a unix named socket or a host:port. This value must match the value specified for
the INPUT_MAIL_FILTER() macro in the sendmail.mc file. The accepted syntax is:

<blockquote>
<dl>
<dt><code>{unix|local}:/path/to/file</code></dt><dd>A named pipe. (default)</dd>
<dt><code>inet:port@{hostname|ip-address}</code></dt><dd>An IPV4 socket.</dd>
<dt><code>inet6:port@{hostname|ip-address}</code></dt><dd>An IPV6 socket.</dd>
</dl>
</blockquote>
</dd>

<a name="opt_milter_timeout"></a>
<dt><span class="syntax">milter-timeout=</span><span class="param">7210</span></dt>
<dd>The sendmail/milter I/O timeout in seconds.</dd>

<a name="opt_pid_file"></a>
<dt><span class="syntax">pid-file=</span><span class="param">/var/run/milter/@PACKAGE_NAME@.pid</span></dt>
<dd>The file path of where to save the process-id.
</dd>

<a name="opt_primary_up_reject"></a>
<dt><span class="syntax">-primary-up-reject</span></dt>
<dd>
We are a backup MX and we want to reject mail when the primary
MX is available. This does not conform with RFC 974 &amp; 2821 mail
routing, which only requires mail clients attempt delivery to the
primary first, before trying other MXes.
<p>
Spammers often attempt to by-pass spam filters by sending email
directly to secondary MX machines, which often have weaker requirements.
This option essentially demands that a client only deliver to the primary
MX when it is available.
</p>
</dd>

<a name="opt_quit"></a>
<dt><span class="syntax">-quit</span> or <span class="syntax">+quit</span></dt>
<dd>Quit an already running instance of the milter and exit.
This is equivalent to: <nobr><code>kill -QUIT `cat /var/run/milter/@PACKAGE_NAME@.pid`</code></nobr>
</dd>

<a name="opt_reject_percent_relay"></a>
<dt><span class="syntax">-reject-percent-relay</span></dt>
<dd>Reject a RCPT if it uses a routed address (the %-hack).
</dd>

<a name="opt_relay_mail_from"></a>
<dt><span class="syntax">-relay-mail-from</span></dt>
<dd>
Use the original MAIL FROM:&lt;sender&gt; given instead of the MAIL FROM:&lt;&gt;
when performing the call-ahead. Note if the server being called ahead performs
any call-back or call-ahead tests themselves, then this
option may have negative undefined results.
</dd>

<a name="opt_restart"></a>
<dt><span class="syntax">-restart</span> or <span class="syntax">+restart</span></dt>
<dd>Terminate an already running instance of the milter before starting.
</dd>

<a name="opt_run_group"></a>
<dt><span class="syntax">run-group=</span><span class="param">milter</span></dt>
<dd>The process runtime group name to be used when started by root.</dd>

<a name="opt_run_user"></a>
<dt><span class="syntax">run-user=</span><span class="param">milter</span></dt>
<dd>The process runtime user name to be used when started by root.</dd>

<a name="opt_smtp_timeout"></a>
<dt><span class="syntax">smtp-timeout=</span><span class="param">120</span></dt>
<dd>Specify the socket timeout in seconds to wait for SMTP responses during the
call ahead. A zero (0) value will set the timeout to indefinite.
</dd>

<!--
<a name="opt_try_implicit_mx"></a>
<dt><span class="syntax">-try-implicit-mx</span></dt>
<dd>Try the implicit MX for {rcpt_host} when no other MX answers.
Used in special cases where for example departmental subdomain MXes point to
a gateway MX and rely on the implicit MX rule with an A record to route
the mail internally to the departmental mail store.
</dd>
-->

<a name="opt_verbose"></a>
<dt><span class="syntax">verbose=</span><span class="param">info</span></dt>
<dd>A comma separated list of how much detail to write to the mail log.
Those mark with <span class="syntax">&sect;</span> have meaning for this milter.

<blockquote>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tr>
	<td class="tline" width="4%"><span class="syntax">&sect;</span></td>
	<td class="tline" width="21%">all</td>
	<td class="tline" width="75%">All messages</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>0</td>
	<td>Log nothing.</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>info</td>
	<td>General info messages. (default) </td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>trace</td>
	<td>Trace progress through the milter.</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>parse</td>
	<td>Details from parsing addresses or special strings.</td>
</tr>
<tr>
	<td><span class="syntax">&nbsp;</span></td>
	<td>debug</td>
	<td>Lots of debug messages.</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>dialog</td>
	<td>I/O from Communications dialog</td>
</tr>
<tr>
	<td><span class="syntax">&nbsp;</span></td>
	<td>state</td>
	<td>State transitions of message body scanner.</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>dns</td>
	<td>Trace &amp; debug of DNS operations</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>cache</td>
	<td>Cache get/put/gc operations.</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>database</td>
	<td>Sendmail database lookups.</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>socket-fd</td>
	<td>Socket open &amp; close calls</td>
</tr>
<tr>
	<td><span class="syntax">&sect;</span></td>
	<td>socket-all</td>
	<td>All socket operations &amp; I/O</td>
</tr>
<tr>
	<td class="bline"><span class="syntax">&sect;</span></td>
	<td class="bline">libmilter</td>
	<td class="bline">libmilter engine diagnostics</td>
</tr>
</table>
</blockquote>
</dd>

<a name="opt_version"></a>
<dt>&plusmn;<span class="syntax">version</span></dt>
Show version and copyright.
</dd>

<a name="opt_work_dir"></a>
<dt><span class="syntax">work-dir=</span><span class="param">/var/tmp</span></dt>
<dd>The working directory of the process. Normally serves no purpose unless the
kernel option that permits daemon process core dumps is set.
</dd>
</dl>

<!-- End Common Milter Options -->

<a name="responses"></a>
<h3>SMTP Responses</h3>
<p>
This is the list of possible SMTP responses generated by <code>@PACKAGE_NAME@</code>.
</p>

<dl>
<!-- BEGIN parsePath() errors -->
<dt><tt>553 	5.1.0 	imbalanced angle brackets in path</tt></dt>
<dd>The path given for a MAIL or RCPT command is missing a closing angle bracket</dd>

<dt><tt>553 	5.1.0	address does not conform to RFC 2821 syntax</tt></dt>
<dd>The address is missing the angle brackets, &lt; and &gt;, as required by the RFC grammar.</dd>

<dt><tt>553 	5.1.0	local-part too long</tt></dt>
<dd>The stuff before the @ is too long.</dd>

<dt><tt>553 	5.1.[37]	invalid local part</tt></dt>
<dd>The stuff before the @ sign contains unacceptable characters.</dd>

<dt><tt>553 	5.1.0	domain name too long</tt></dt>
<dd>The stuff after the @ is too long.</dd>

<dt><tt>553 	5.1.7	address incomplete</tt></dt>
<dd>Expecting a domain.tld after the @ sign and found none.</dd>

<dt><tt>553 	5.1.[37]	invalid domain name</tt></dt>
<dd>The domain after the @ sign contains unacceptable characters.</dd>
<!-- END parsePath() errors -->

<dt><tt>553 	5.1.0	cannot deliver to null address</tt></dt>
<dd>Sender said RCPT TO:&lt;&gt; and Sendmail didn't catch it.</dd>

<dt><tt>550		5.7.1	routed address relaying denied</tt></dt>
<dd>The recipient address tried to use the %-hack for routed address relaying.
See <a href="#opt_reject_percent_relay">reject-percent-relay</a> option.
</dd>


<!-- BEGIN call ahead errors -->
<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; communication error</tt></dt>
<dd>An internal error occured. See the mail log for details.</dd>

<!-- <dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; broke connection</tt></dt> -->

<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; not answering</tt></dt>
<dd>The server given by the {rcpt_host} macro or <a href="#opt_call_ahead_host">call-ahead-host</a> option could not be reached.</dd>

<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; responded with a busy signal</tt></dt>
<dd>The server given by the {rcpt_host} macro or <a href="#opt_call_ahead_host">call-ahead-host</a> option return a 421 busy signal.</dd>

<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; provides no SMTP service</tt></dt>
<dd>The server given by the {rcpt_host} macro or <a href="#opt_call_ahead_host">call-ahead-host</a> option return a 554 no service.</dd>

<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; responded with \".*\"</tt></dt>
<dd>The server given by the {rcpt_host} macro or <a href="#opt_call_ahead_host">call-ahead-host</a> option return an unexpected welcome response.</dd>

<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; did not accept HELO</tt></dt>
<dd>Received something other than a 250 return code for the HELO command.</dd>

<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; does not accept &lt;&gt; address as required by RFC 821, 1123, 2505, and 2821</tt></dt>
<dd>The MAIL FROM:&lt;&gt; command was reject contrary to RFC requirements. See the <a href="#opt_primary_up_reject">relay-mail-from</a> option.</dd>

<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; rejected sender address saying \".*\"</tt></dt>
<dd>The MAIL FROM:&lt;sender&gt; was rejected. See the <a href="#opt_primary_up_reject">relay-mail-from</a> option.</dd>

<dt><tt>xyz		x.7.1	server [^ ]+ for &lt;[^&gt;]+&gt; rejected address saying \".*\"</tt></dt>
<dd>The RCPT TO:&lt;recipient&gt; command was rejected.</dd>

<dt><tt>450		4.7.1	primary MX [^ ]+ online and accepting mail</tt></dt>
<dd>See the <a href="#opt_primary_up_reject">primary-up-reject</a> option.</dd>
<!-- END call ahead errors -->

</dl>


<a name="Installation"></a>
<div align="center">
<br/>
<a href="#">Description &amp; Usage</a> &deg;
<a href="#Installation">Installation &amp; Notes</a> &deg;
<a href="#License">License &amp; Support</a>
</div>
<h3>Installation</h3>
<ol>
<li><p>
Download:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tr>
	<td class="tline bline"><a href="http://www.snertsoft.com/download/@PACKAGE_NAME@-@PACKAGE_VERSION@.tar.gz">@PACKAGE_NAME@/@PACKAGE_VERSION@</a></td>
	<td class="tline bline"><a href="@PACKAGE_NAME@.md5">md5sum</a></td>
	<td class="tline bline"><a href="CHANGES.TXT">Change Log</a></td>
</tr>
<tr>
	<td class="bline"><a href="http://www.snertsoft.com/download/libsnert-current.tar.gz">LibSnert</a></td>
	<td class="bline"><a href="@PACKAGE_NAME@.md5">md5sum</a></td>
	<td class="bline"><a href="CHANGES-LIBSNERT.TXT">Change Log</a></td>
</tr>
<tr>
	<td class="bline"><a href="http://www.sendmail.org/">Sendmail 8.14</a></td>
	<td class="bline">&nbsp;</td>
	<td class="bline"><a href="http://www.sendmail.org/">http://www.sendmail.org/</a></td>
</tr>
<tr>
	<td class="bline"><a href="http://www.sleepycat.com/download/">Berkeley DB</a></td>
	<td class="bline">&nbsp;</td>
	<td class="bline"><a href="http://www.sleepycat.com/">http://www.sleepycat.com/</a></td>
</tr>
</table>
</blockquote>
</li>


<li>
<p>
If you have never built a milter for Sendmail, then please make sure that you
build and install <code>libmilter</code>, which is <i>not</i> built by default when you build Sendmail.
Please read the <code>libmilter</code> documentation. Briefly, it should be something like this:
</p>
<blockquote><pre>
cd (path to)/sendmail-8.14.0/libmilter
sh Build -c install
</pre></blockquote>
</li>

<li>
<p>
The build process for <code>libsnert</code> and <code>@PACKAGE_NAME@</code> is pretty straight forward
once you have <code>libmilter</code> installed:
</p>

<blockquote><pre>
cd (path to)/com/snert/src/lib
./configure
make build
cd ../@PACKAGE_NAME@
./configure
make build
make install
</pre></blockquote>

<p>
Both configuration scripts have some options that allow you to override defaults. Those options
are listed with:
</p>
<blockquote><pre>
./configure --help
</pre></blockquote>

</li>

<li>
<p>
An example <code>@datadir@/examples/@PACKAGE_NAME@/@PACKAGE_NAME@.mc</code> is supplied.
This file should be reviewed and the necessary elements inserted into your Sendmail
<code>.mc</code> file and <code>sendmail.cf</code> rebuilt.
Please note the comments on the general milter flags.
</p>
<pre>
<!--#include file="sample.mc" -->
</pre>
</li>

<li>
<p>Once installed and configured, start <code>@PACKAGE_NAME@</code> and then restart Sendmail.
An example startup script is provided in <code>@datadir@/examples/@PACKAGE_NAME@/@PACKAGE_NAME@.sh</code>.
The default options can be altered by specifying them on the command-line or
within a <code>/etc/mail/@PACKAGE_NAME@.cf</code>. The <code>@PACKAGE_NAME@.cf</code> is
parsed first followed by the command-line options.
</p>
</li>
</ol>


<a name="Notes"></a>
<h3>Notes</h3>

<ul>
<li><p>
Currently tested platforms:
</p>
<blockquote>
<!-- <code>FreeBSD 4.4+ (x386)</code>; -->
<code>Cobalt Qube 1 with Linux RH 5.1 (mips 2.0.34 kernel)</code>;
<code>Linux RH 5.1 (Intel x386 2.2.25 kernel)</code>;
<code>FreeBSD 4.8, 4.9 (Intel x386)</code>;
<code>OpenBSD 3.6 (Intel x386)</code>
</blockquote>
</li>

<li>
<p>
The minimum desired file ownership and permissions are as follows for a typical Linux system.
For FreeBSD, NetBSD, and OpenBSD the binary and cache locations may differ, but have the same
permissions.
</p>

<p>
Process user ``milter'' is primary member of group ``milter'' and
secondary member of group ``smmsp''. Note that the milter should
be started as root, so that it can create a .pid file and .socket
file in /var/run; after which it will switch process ownership to
milter:milter before starting the accept socket thread.
</p>

<blockquote>
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr>
	<td width="40%">/etc/mail/</td><td width="20%">root:smmsp</td><td width="40%"><tt>0750 drwxr-x---</tt></td>
</tr>
<tr>
	<td>/etc/mail/access.db</td><td>root:smmsp</td><td><tt>0640 -rw-r-----</tt></td>
</tr>
<tr>
	<td>/etc/mail/sendmail.cf</td><td>root:smmsp</td><td><tt>0640 -rw-r-----</tt></td>
</tr>
<tr>
	<td>/etc/mail/@PACKAGE_NAME@.cf</td><td>root:root</td><td><tt>0644 -rw-r--r--</tt></td>
</tr>
<tr>
	<td>/var/run/milter/@PACKAGE_NAME@.pid</td><td>milter:milter</td><td><tt>0644 -rw-r--r--</tt></td>
</tr>
<tr>
	<td>/var/run/milter/@PACKAGE_NAME@.socket</td><td>milter:milter</td><td><tt>0644 srw-r--r--</tt></td>
</tr>
<tr>
	<td>/var/db/@PACKAGE_NAME@</td><td>milter:milter</td><td><tt>0644 -rw-r--r--</tt> (*BSD)</td>
</tr>
<tr>
	<td>/var/cache/@PACKAGE_NAME@</td><td>milter:milter</td><td><tt>0644 -rw-r--r--</tt> (linux)</td>
</tr>
<tr>
	<td>/usr/local/libexec/@PACKAGE_NAME@</td><td>root:milter</td><td><tt>0550 -r-xr-x---</tt></td>
</tr>
</table>
</blockquote>

</li>

<li><p>
We would like to express our thanks to Derek Balling for his support at
<a href="http://www.milter.org/">http://www.milter.org/</a> and to April Lorenzen
for her poking and proding to create this milter.
</p></li>

</ul>

<a name="Feeback"></a>
<h3>User Feeback</h3>

<dl>

<dt>April Lorenzen</dt><dd>
We have a sendmail gateway in front of an IMail pop/webmail server. @PACKAGE_NAME@ makes it effortless for the
gateway to know both users and aliases on the pop server, without messy alias/user gathering scripts and
cron jobs. @PACKAGE_NAME@ allows us to reject mail to unknown users immediately, before accepting the message
content. We are using it to reject thousands of dictionary attack spammers, viruses, and addresses that got
on "millions of addresses" spammer cds from customers who used to have catch all accounts.
</dd>

</dl>


<a name="License"></a>
<div align="center">
<br/>
<a href="#">Description &amp; Usage</a> &deg;
<a href="#Installation">Installation &amp; Notes</a> &deg;
<a href="#License">License &amp; Support</a>
</div>

<!-- License Agreement -->

<h3>License Agreement 1.8</h3>
<p>
SNERTSOFT &amp; CO. ARE WILLING TO LICENSE THE SOFTWARE IDENTIFIED ABOVE TO YOU
ONLY UPON THE CONDITION THAT YOU ACCEPT ALL OF THE TERMS CONTAINED
IN THIS LICENSE AGREEMENT. PLEASE READ THE AGREEMENT CAREFULLY. BY
DOWNLOADING OR INSTALLING THIS SOFTWARE, YOU ACCEPT THE TERMS OF THE
AGREEMENT.
</p>

<ol style="clear: both; padding: 10px 0px 0px 1.2em;">
<li><h4>Definitions</h4>
	<ol>
	<li><p>
``Package'' means the identified above in source and/or binary
form, any other machine readable materials provided (including,
but not limited to documentation, sample files, data files),
any updates or error corrections, and its derivative works.
	</p></li>
	<li><p>
``Organisation'' means a legal entity or an individual.
	</p></li>
	<li><p>
``You'' (or ``Your'') means an Organisation
 exercising rights under, and complying with all of the terms of,
 this License or a future version of this License issued under
 Section 6.1.  For legal entities, ``You'' includes any entity
 which controls, is controlled by, or is under common control with
 You.  For purposes of this definition,``control'' means (a) the
 power, direct or indirect, to cause the direction or management
 of such entity, whether by contract or otherwise, or (b)
 ownership of more than fifty percent (50%) of the outstanding
 shares or beneficial ownership of such entity.
	</p></li>
	<li><p>
``SnertSoft'' means Anthony C. Howe situated in Cannes, France
(SIRET #489 259 937 00014).
	</p></li>
	<li><p>
``SnertSoft &amp; Co.'' means SnertSoft and all authorised &amp;
licensed partners, such as value-added resellers or appliance manufacturers.
	</p></li>
	</ol>
</li>

<li><h4>Statement of Original Work</h4>
	<ol>
	<li><p>
The Package is an original work written by SnertSoft,
with exception of following third party code:
	</p>
		<ol>
		<li><p>
MD5 routines written by L. Peter Deutsch, based on RFC 1321;
		</p></li>
		<li><p>
SQLite3 package is written by D. Richard Hipp of Hwaci
and is in the public domain.
		</p></li>
		<li><p>

strnatcmp.c is written by Martin Pool of sourcefrog.net and
     	has a BSD style license.
		</p></li>
		<li><p>
Protothreads headers originally written by Adam Dunkels and
has a BSD style license.
		</p></li>


		</ol>
	</li>
	</ol>
</li>


<li><h4>License To Use</h4>
	<ol>
	<li><p>
You may install and use this Package, without modifications,
exclusively on machines for which You have purchased a license,
provided You retain this notice, SnertSoft's copyright notice,
any and all license control methods (<a href="#License_Control">see below</a>),
and any links within the Package back to the most current online versions of
this License and Disclaimer.
	</p></li>
	<li><p>
You may copy, share, distribute, modify, and create derivative
works from the user manuals and any related documentation
solely for Your internal business purposes, such as in-house
documentation, training manuals, or reference material.
	</p></li>
	</ol>
</li>


<li><h4>Restrictions</h4>
	<ol>
	<li><p>
Redistribution, including but not limited to books, CDROMS,
download mirrors, floppy diskettes, hard disks, hardcopy print
outs, online archives, solid state disks, streaming tapes, or
other current or future forms of storage or communication media
of the Package, with or without modifications, including any
and all derivative works such as source patches, binaries,
binary patches, or similar is expressly forbidden without prior
written permission in hardcopy (ie. letter or fax) signed and dated
by SnertSoft.
	</p></li>
	<li><p>
It is expressly forbidden for You to use the Package, in whole
or in part, in any other software or appliance without prior
written permission in hardcopy (ie. letter or fax) signed and dated
by SnertSoft.
	</p></li>
	<li><p>
It is expressly forbidden for You to use the Package to develop
any software or other technology having the same primary
function as the Package, including but not limited to using the
Package in any development or test procedure that seeks to
develop like software or other technology, or determine if such
software or other technology performs in a similar manner as
the Package.
	</p></li>
	<li><p>
You may not sell, rent, lease, or transfer the Package to third
parties without prior written permission in hardcopy (ie. letter or fax)
signed and dated by SnertSoft.
	</p></li>
	</ol>
</li>


<li><h4>Termination</h4>
	<ol>
	<li><p>
This Agreement is effective until terminated. You may
terminate this Agreement at any time by destroying all copies
of the Package.
	</p></li>
	<li><p>
This Agreement will terminate immediately without
notice from SnertSoft if You fail to comply with any provision
of this Agreement.
	</p></li>
	<li><p>
Either party may terminate this Agreement
immediately should any portion of the Package become, or in
either party's opinion be likely to become, the subject of a
claim of infringement of any intellectual property right. Upon
Termination, You must destroy all copies of the Package.
	</p></li>
	</ol>
</li>


<li><h4>Versions Of The License</h4>
	<ol>
	<li><p>
New Versions. SnertSoft may publish revised and/or new
versions of the License from time to time. Each version will
be given a distinguishing version number.
	</p></li>
	<li><p>
Effect of New Versions. Once a version of the Package has been
published under a particular version of the License, You may
always continue to use it under the terms of that License
version. You may also choose to use such Package under the
terms of the most current version of the License published by SnertSoft.
	</p></li>
	<li><p>
No one other than SnertSoft has the right to modify
the terms applicable to the Package created under this License.
	</p></li>
	</ol>
</li>
</ol>


<h3>Disclaimer</h3>

<p>
THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO WAY SHALL SNERTSOFT OR LICENSEE BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
</p>

<a name="License_Control"></a>
<h3>License Control</h3>
<p>
The Package may use one or more license control methods including, but
not limited to, license key activation, periodic reporting of Package
details and IP address of installation to SnertSoft &amp; Co., or remote license
verification by SnertSoft &amp; Co.. Any information reported to
or gathered by SnertSoft &amp; Co. shall remain strictly
confidential and the private property of SnertSoft &amp; Co.. Under no
circumstances will SnertSoft &amp; Co. resell or release this information to third
parties, unless demanded by court order.
</p>

<a name="Support"></a>
<h3>Support</h3>

<p>
Support is provided for one year from date of purchase and only for SnertSoft's original
Package that was purchased directly from SnertSoft. Additional support beyond the first
year can be obtained from SnertSoft on time &amp; materials basis or from one of SnertSoft's
authorised partners.
</p>
<p>
Support for the Package obtained from authorised partners, such as value-added resllers or
appliance manufacturers, will be supplied by those partners. SnertSoft will not support
the Package without proof of purchase from SnertSoft, such as an Order N&deg; or Invoice N&deg;.
</p>
<p>
Package enhancements requests and product suggestions are always welcome.
A community mailing list is available; please refer to
<a href="http://www.snertsoft.com/">SnertSoft</a> web site Support area for details.
</p>

<!-- end License Agreement -->

<a name="Gifts"></a>
<h3>Gifts</h3>

<p>
Gifts from the author's <a href="http://www.amazon.com/">Amazon US</a> or <a href="http://www.amazon.co.uk/">Amazon UK</a> wishlist (search by mail address &lt;achowe
at snert dot com&gt;) are welcomed for the continued encouragement, moral support, and ego pumping needed to work in
foreign non-english speaking lands.
</p>

<div align="center">
<br/>
<a href="#">Description &amp; Usage</a> &deg;
<a href="#Installation">Installation &amp; Notes</a> &deg;
<a href="#License">License &amp; Support</a>
</div>

<!-- copyright -->
<p class="copyright" style="text-align: center;">
<nobr>@package_copyright@</nobr>
</p>
<!--end copyright-->

<p class="small" style="text-align: center;">
<!--#include virtual="/cgi-bin/counter.cgi/sendmail/@PACKAGE_NAME@/counter.dat" -->
pretzels since 24 January 2004
</p>

</td></tr>
</table>
</div>
</body>
</html>
